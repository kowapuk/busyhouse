import bme280import ssd1306import wifiimport jsonfrom machine import Pin, RTC, I2Cfrom neopixel import NeoPixelfrom utime import sleep_msfrom mqtt_writer import MQTTWriter# GPIO5 - yellow, GPIO4 - blue, GPIO0 - green, GPIO2 - red# GPIO14 - np scl = Pin(13)sda = Pin(0)led     = const(14)yellow  = const(5)blue    = const(4)red     = const(2)green   = const(12)SET_COM_OUT_DIR  = const(0xc0)SET_SEG_REMAP    = const(0xa0)topic_leds = 'kowapuk/feeds/leds_output'topic_hum = 'kowapuk/feeds/humidity'topic_temp = 'kowapuk/feeds/temperature'class House():    def __init__(self):    self.timer = RTC()    self.np = NeoPixel(Pin(led), 25)    self.i2c = I2C(scl=scl, sda=sda, freq=100000)    self.init_device()    self.init_server()        self.yel_but = Pin(yellow, Pin.IN)    self.blu_but = Pin(blue, Pin.IN)    self.red_but = Pin(red, Pin.IN)    self.gre_but = Pin(green, Pin.IN)    self.beep = Pin(15, Pin.OUT)    self.raw = 24    self.col = 0    # вреction = 6    self.fill_field = [0] * 25    self.speed = 5  def init_device(self):    self.oled = ssd1306.SSD1306_I2C(128, 64, self.i2c)    if self.oled:      self.oled.write_cmd(SET_COM_OUT_DIR)             # mirror vertically      self.oled.write_cmd(SET_SEG_REMAP)               # mirror horizontally (64 rows)\    else:      pass    self.bme = bme280.BME280(i2c=self.i2c)    print('Devices ok')      def init_server(self):    if wifi.wifi_connect():      self.oled.text('Connected to Home Wi-Fi', 0, 0)      self.oled.text('Home Wi-Fi', 0, 8)      self.oled.show()    self.client = MQTTWriter()    self.oled.text('Connected to', 0, 16)    self.oled.text('Adafruit IO-MQTT', 0, 24)    self.oled.show()    sleep_ms(500)    self.oled.fill(0)  def leds_on(self, color):    self.np.fill(color)    self.np.write()  def led_on(self, pos, color):    self.np[pos] = color    self.np.write()  def run_up(self, color):    if self.fill_field.count(0) == 0:        self.fill_field = [0] * 25        self.np.fill((0,0,0))        self.np.write()    count = 0    for each in range(self.fill_field.count(0)):        if count == 0:            self.fill_field[each] = color            self.led_on(each, color)        else:            self.fill_field[each-1] = 0            self.led_on(each-1, (0, 0, 0))            self.fill_field[each] = color            self.led_on(each, color)        sleep_ms(100)        count += 1  def check_but(self, but):    if but.value():      return True    else:       return False  def clear_field(self, s_raws, f_raws, s_cols, f_cols):    for raw in range(s_raws, f_raws):      for col in range(s_cols, f_cols):        self.oled.hline(raw, col, 128, 0)    self.oled.show()  def show_bme(self):    val = self.bme.values    t = "T:{}".format(val[0])    p = "P:{}".format(val[1])    h = "H:{}".format(val[2])        self.client.on_next(topic=topic_hum, data=json.dumps(float(val[2][:4])))    self.client.on_next(topic=topic_temp, data=json.dumps(float(val[0][:4])))    # Clear     self.clear_field(0, 1, 0, 24)    self.oled.text(t, 0, 0)    self.oled.text(p, 0, 8)    self.oled.text(h, 0, 16)    self.oled.show()    def but_event(self, but, color, name):            self.beep.on()      sleep_ms(100)      self.beep.off()            count = 0       while self.check_but(but):        count += 1        sleep_ms(200)      if count >=10:        self.leds_on(color)        self.oled.text(name + ' All', self.col, self.raw)        self.raw += 8                self.client.on_next(topic=topic_leds, data=json.dumps(name+' All'))      else:                self.run_up(color=color)        self.oled.text(name, self.col, self.raw)        self.raw += 8                self.client.on_next(topic=topic_leds, data=json.dumps(name))  def run(self):    print('Run')    print('During work to 10 cycles')    # Per 30 second    self.timer.alarm(0, 5*60000)    self.show_bme()    while self.timer.alarm_left() > 0:      if self.check_but(self.blu_but):        self.but_event(self.blu_but, (0, 0, 20), 'Blue')      elif self.check_but(self.gre_but):        self.but_event(self.gre_but, (0, 20, 0), 'Green')              elif self.check_but(self.red_but):        self.but_event(self.red_but, (20, 0, 0), 'Red')      elif self.yel_but.value():        self.but_event(self.yel_but, (20, 20, 0), 'Yellow')      if self.raw >= 64:        self.clear_field(0, 1, 24, 65)        self.raw = 24      self.oled.show()          self.np.fill((0,0,0))    self.np.write()        # Start dev = House()while True:  print('Working')  dev.run()